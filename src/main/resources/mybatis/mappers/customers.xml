<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jhta.moviefan.dao.CustomerDao">

	<resultMap type="com.jhta.moviefan.vo.Customer" id="CustomerResultMap">
		<id 	column="customer_no" 			property="no" />
		<result column="grade_code" 			property="gradeCode" />
		<result column="customer_id" 			property="id"/>
		<result column="customer_password"		property="password"/>
		<result column="customer_phone_number" 	property="phoneNumber"/>
		<result column="customer_email" 		property="email"/>
		<result column="customer_gender" 		property="gender"/>
		<result column="customer_birthday" 		property="birthday"/>
		<result column="customer_total_point" 	property="totalPoint"/>
		<result column="is_admin" 				property="isAdmin"/>
		<result column="customer_name" 			property="name"/>
		<result column="customer_nickname" 		property="nickName"/>
		<result column="is_banned" 				property="isBanned"/>
		<result column="customer_login_type" 	property="loginType"/>
		<result column="customer_created_date" 	property="createdDate"/>
		<result column="is_withdrawal" 			property="isWithdrawal"/>
		<result column="customer_updated_date" 	property="updatedDate"/>
	</resultMap>

	<select id="getCustomerByNo" parameterType="int" resultMap="CustomerResultMap">
		select 
			*
		from
			customer
		where
			customer_no = #{no}
	</select>
	
	<select id="getCustomerById" parameterType="String" resultMap="CustomerResultMap">
		select 
			*
		from
			customer
		where
			customer_id = #{id}
	</select>
	
	<select id="getCustomerByEmail" parameterType="String" resultMap="CustomerResultMap">
		select 
			*
		from
			customer
		where
			customer_email = #{email}
	</select>
	
	<select id="getCustomerByPhoneNumber" parameterType="String" resultMap="CustomerResultMap">
		select 
			*
		from
			customer
		where
			customer_phone_number = #{phoneNumber}
	</select>
	
	<select id="getCustomerByNickName" parameterType="String" resultMap="CustomerResultMap">
		select 
			*
		from
			customer
		where
			customer_nickname = #{nickName}
	</select>
	
	<select id="getCustomerMovieWishListByCustomerNo" parameterType="int" resultType="com.jhta.moviefan.vo.CustomerMovieWishList">
		select 
			movie_no	as	movieNo,
			customer_no	as	customerNo
		from
			customer_movie_wishlist
		where
			customer_no = #{customerNo}
	</select>

	<insert id="insertCustomer" parameterType="com.jhta.moviefan.vo.Customer">
		<selectKey keyProperty="no" resultType="int" order="BEFORE">
			select customer_seq.nextval
			from dual
		</selectKey>
		insert into customer
		(customer_no, customer_id, customer_password, customer_phone_number, customer_login_type,
		customer_email, customer_gender, customer_birthday, customer_name, customer_nickname)
		values
		(#{no}, #{id}, #{password}, #{phoneNumber}, #{loginType}, 
		#{email}, #{gender}, #{birthday}, #{name}, #{nickName})
	</insert>
	
	<update id="updateCustomer" parameterType="com.jhta.moviefan.vo.Customer">
		update customer
		set
			customer_password = #{password},
			customer_nickname = #{nickName},
			customer_email = #{email},
			customer_phone_number = #{phoneNumber},
			customer_gender = #{gender},
			customer_birthday = #{birthday},
			customer_updated_date = sysdate
		where 
			customer_no = #{no}
	</update>
	
	<update id="deleteCustomerByNo" parameterType="int">
		update customer
		set
			is_withdrawal = 'Y'
		where
			customer_no = #{customerNo}
	</update>
	
</mapper>




































